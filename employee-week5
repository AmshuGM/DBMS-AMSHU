create database week5;
use week5;

create table DEPT(
  DEPTNO int,
  DNAME varchar(20) ,
  DLOC varchar(30),
  primary key(DEPTNO) 
  
  


);




create table EMPLOYEE(
EMPNO int,
 EMPNAME varchar(20),
 MGR_NO int,
 HIREDATE VARCHAR(10),
 SAL INT,
 DEPTNO INT,
 primary key(EMPNO),
 FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO) ON DELETE CASCADE ON UPDATE CASCADE
 
); 

CREATE TABLE PROJECT(
    PNO INT,
    PLOC VARCHAR(30),
    PNAME VARCHAR(20),
    PRIMARY KEY(PNO)

);

CREATE TABLE INCENTIVES(
    EMPNO INT,
    INCENTIVE_DATE VARCHAR(10),
    INCENTIV_AMOUNT INT,
    PRIMARY KEY(EMPNO)
     

);


CREATE TABLE ASSIGNED_TO(
   EMPNO INT,
   PNO INT,
   JOB_ROLE VARCHAR(20),
   primary key(EMPNO),
   FOREIGN KEY(EMPNO) REFERENCES EMPLOYEE(EMPNO) ON DELETE CASCADE ON UPDATE CASCADE,
   FOREIGN KEY(EMPNO) REFERENCES INCENTIVES(EMPNO) ON DELETE CASCADE ON UPDATE CASCADE,
   FOREIGN KEY (PNO) REFERENCES PROJECT(PNO) ON DELETE CASCADE ON UPDATE CASCADE

);

-- 3. Retrieve the employee numbers of all employees who work on project located in Bengaluru, Hyderabad, or Mysuru
-- 4. Get Employee ID’s of those employees who didn’t receive incentives
-- 5. Write a SQL query to find the employees name, number, dept, job_role, department location and project location who are working for a project location same as his/her department location.



-- QUERY 5

SELECT E.EMPNAME,E.EMPNO,D.DNAME,A.JOB_ROLE,D.DLOC,P.PLOC
FROM EMPLOYEE E
INNER JOIN  DEPT D
ON D.DEPTNO=E.DEPTNO
INNER JOIN ASSIGNED_TO A
ON A.EMPNO=E.EMPNO
INNER JOIN PROJECT P
ON P.PNO=A.PNO WHERE P.PLOC=D.DLOC;

-- QUERY 4

SELECT E.EMPNO
FROM EMPLOYEE E,INCENTIVES I
WHERE E.EMPNO!=I.EMPNO;


-- QUERY 3

SELECT E.EMPNO
FROM EMPLOYEE E
INNER JOIN DEPT D
ON D.DEPTNO=E.DEPTNO
WHERE DLOC IN ("BANGALORE","HYDERBAD","MYSORE");











